{{#each eventos}}

<!-- Modal Editar -->
<div class="modal fade" id="editarObra{{id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
    aria-hidden="true">
    <div class="modal-dialog" style="width: 90vw;" role="document">
        <div class="modal-content p-3">
            <div class="modal-header">
                <div class="modal-title">Editar Evento </div>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form action="/dashboard/eventos/editar/{{id}}" method="POST" enctype="multipart/form-data" class="form">
           
            <div class="row">
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="nombre">Nombre</label>
                        <input type="text" class="form-control" id="nombre" name="nombre" aria-describedby="Nombre"
                            placeholder="{{nombre}}" value="{{nombre}}" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="titulo">Título</label>
                        <input type="text" class="form-control" id="titulo" name="titulo" aria-describedby="titulo"
                            placeholder="titulo" value="{{titulo}}" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="organizadores">Organizadores</label>
                        <input type="text" class="form-control" id="organizadores" name="organizadores"
                            aria-describedby="organizadores" placeholder="{{organizadores}}" value="{{organizadores}}" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="hora">Hora de Apertura</label>
                        <input type="time" class="form-control" id="hora" name="hora" aria-describedby="hora" placeholder="{{hora_inicio}}" value="{{hora_inicio}}" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="inicio">Fecha de Inicio</label>
                        <input type="date" class="form-control" id="inicio" name="inicio" placeholder="{{fecha_inicio}}" value="{{fecha_inicio}}" aria-describedby="inicio"
                            required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="fin">Fecha de Fin</label>
                        <input type="date" class="form-control" id="fin" name="fin" aria-describedby="fin" placeholder="{{fecha_fin}}" value="{{fecha_fin}}" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="local">Local</label>
                        <input type="text" placeholder="{{dir_local}}" value="{{dir_local}}" class="form-control" id="local"
                            name="local" aria-describedby="local" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="direccion">Dirección</label>
                        <input type="text" class="form-control" id="direccion" name="direccion" value="{{direccion}}" placeholder="{{direccion}}"
                            aria-describedby="direccion" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="ciudad">Ciudad</label>
                        <input type="text" placeholder="{{ciudad}}" value="{{ciudad}}" class="form-control" id="ciudad" name="ciudad"
                            aria-describedby="local" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="pais">País</label>
                        <input type="text" class="form-control" id="pais" name="pais" placeholder="{{pais}}" value="{{pais}}"
                            aria-describedby="pais" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="piezas">Número de piezas</label>
                        <input type="number" placeholder="{{piezas}}" value="{{piezas}}" class="form-control" id="piezas" name="piezas"
                            aria-describedby="piezas" required>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="form-group">
                        <label for="estilo">Estilo</label>
                        <input type="text" class="form-control" id="estilo" name="estilo" value="{{estilo}}" placeholder="{{estilo}}"
                            aria-describedby="estilo" required>
                    </div>
                </div>
                
                <div class="col-12 text-right">
                    <button type="submit" class="guardar-obra">  Guardar </button>
                </div>
            </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal Borrar -->
<div class="modal fade" id="borrar-obra{{id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Borrar evento</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>¿Estás seguro de que deseas eliminar este evento? Esta acción es permanente, se perderan todos los
                    datos que corresponden a este evento.</p>
            </div>
            <div class="modal-footer">
                <a href="/dashboard/eventos/eliminar/{{id}}" type="button" class="btn btn-danger">Eliminar</a>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

{{/each}}

{{> Navigation }}
{{> messages }}


{{> artistSidebar }}

<div class="container-fluid">
    <div class="content-admin">
        <div class="row">
            <div class="col-lg-6 col-12">
                <div class="m-5">
                    <h2>Mis Eventos</h2>
                </div>
            </div>
            <div class="col-lg-6 col-12">
                <div class="row filtro-lista h-100">
                    <div class="col-10">
                        <input type="text" class="d-inline form-control badge-pill filter-form form-control-sm"
                            placeholder="Buscar" id="inlineFormCustomSelectPref">
                    </div>
                    <div class="col-2">
                        <button type="submit" class="d-inline btn btn-compra badge badge-pill"><i
                                class="fas fa-search"></i></button>
                    </div>
                </div>
            </div>
        </div>
        <div class="section ventas">
            <div class="tabla mis-ventas">
                <table class="table table-borderless my-5">
                    <thead style="background-color: #bda00899;">
                        <tr>
                            <th scope="col">Nombre</th>
                            <th scope="col">Artista</th>
                            <th scope="col">Ubicación</th>
                            <th scope="col">Piezas</th>
                            <th scope="col">Fecha</th>
                            <th scope="col">Horario</th>
                            <th scope="col">Dirección</th>
                            <th scope="col">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each eventos}}
                        <tr class="ml-5">
                            <!-- Enlace a la Obra, vista como el cliente -->
                            <td><button data-toggle="modal" data-target="#datos-obra-modal" class="titulo-mis-obras">
                                    <h2 style="font-weight: bold;">{{nombre}}</h2>
                                </button></td>
                            <!-- Enlace a la colección de la obra -->
                            <td><a href="/artista/{{artista_id}}" class="coleccion-mis-obras">{{nombreArtist}} {{apellido}}</a></td>
                            <!-- Estilo y Precio definidos durante la creación de la obra -->
                            <td class="text-muted">{{dirArtist}} - {{paisArtis}}</td>
                            <!-- Precio sugerido por el administrador, si no ha sugerido aparece vacio -->
                            <td class="gold">{{piezas}}</td>
                            <td class="gold">{{#fecha fecha_inicio}} {{fecha_inicio}} {{/fecha}} </td>
                            <td class="gold">{{hora_inicio}}</td>
                            <td class="gold">{{direccion}}, {{dir_local}}, {{ciudad}} - {{pais}}</td>
                            <!-- Acción de editar esta obra, redirige a "Editar Obra" -->
                            <td>
                                <div class="opciones-admin-list">
                                    <button data-toggle="modal" data-target="#borrar-obra{{id}}" class="borrar"><i
                                            class="fas fa-trash"></i></button>
                                    <button data-toggle="modal" data-target="#editarObra{{id}}" class="editar"><i
                                            class="fas fa-pen"></i></button>

                                </div>
                            </td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{{> sidebarEnd}}

{{> Footer }}

<script>
    $(document).ready(function () {
        $(function () {
            // Multiple images preview in browser
            let k = 0
            let imagesPreview = function (input, placeToInsertImagePreview) {

                if (input.files) {
                    let filesAmount = input.files.length;
                    for (i = 0; i < filesAmount; i++) {
                        let reader = new FileReader();
                        reader.onload = function (event) {
                            let divImage = 'div#' + k;
                            let imageID = 'image' + k;
                            $($.parseHTML('<div>')).attr('id', k).attr('class', 'col-4 col-md-3 col-lg-2 container-image-nueva').appendTo(placeToInsertImagePreview);
                            $($.parseHTML('<img>')).attr('src', event.target.result).attr('id', imageID).attr('onClick', 'eliminar(this.id)').attr('class', 'imagen-galeria-input btn').appendTo(divImage);
                            k++
                        }
                        reader.readAsDataURL(input.files[i]);
                    }
                }

            };

            $('#gallery-photo-add').on('change', function () {
                imagesPreview(this, 'div.gallery');
            });
        });
    });

    function eliminar(e) {
        let node = document.getElementById(e);
        let parent = document.getElementById(node.parentNode.id);

        let gallery = document.getElementById('gallery');

        gallery.removeChild(parent);
    }

    function check() {
        let check = document.getElementById('gridCheck');

        if (check.checked == true) {
            document.querySelector('#label-check').innerText = 'Tu obra se subastará';
        } else {
            document.querySelector('#label-check').innerText = '¿Deseas subastar tu obra?';
        }
    }

    function checkdos() {
        let check = document.getElementById('gridCheck2');

        if (check.checked == true) {
            document.querySelector('#label-check2').innerText = 'Se habilitó la venta de multiples copias';
        } else {
            document.querySelector('#label-check2').innerText = '¿Venderás varias copias?';
        }
    }

    function checktres() {
        let check = document.getElementById('gridCheck3');
        let check4 = document.getElementById('check4');
        let check2 = document.getElementById('check2');
        let check1 = document.getElementById('check1');

        if (check.checked == true) {
            document.querySelector('#label-check3').innerText = 'Ya se vendió el original de la obra';
            check4.style.display = 'block';
            check2.style.display = 'none';
            check1.style.display = 'none';
        } else {
            document.querySelector('#label-check3').innerText = '¿El original de la obra ya se vendió?';
            check2.style.display = 'block';
            check1.style.display = 'block';
            check4.style.display = 'none';
        }
    }

    function checkcuatro() {
        let check = document.getElementById('gridCheck4');

        if (check.checked == true) {
            document.querySelector('#label-check4').innerText = 'Se habilitó la venta para GICLEE';
        } else {
            document.querySelector('#label-check4').innerText = '¿Venderás GICLEE de esta obra?';
        }
    }

    check()
    checkdos()
    checktres()
    checkcuatro()

    // Funciona <3

    const precioA = document.getElementById('precioA');
    const precioB = document.getElementById('precioB');
    const precioC = document.getElementById('precioC');
    const precioF = document.getElementById('precioF');

    precioA.addEventListener('keyup', function () {
        let digitadoA = precioA.value;

        let pA = parseFloat(digitadoA);

        let pB = ((pA / .85) * .15).toFixed(2);
        let pC = (((pA / .85) * 0.036) + 3).toFixed(2);
        let pF = (parseFloat(pA) + parseFloat(pB) + parseFloat(pC)).toFixed(2);

        precioB.setAttribute('value', pB);
        precioC.setAttribute('value', pC);
        precioF.setAttribute('value', pF);
        precioB.value = pB;
        precioC.value = pC;
        precioF.value = pF;
    });

    precioB.addEventListener('keyup', function () {
        let digitadoB = precioB.value;

        let pB = parseFloat(digitadoB);

        let pA = ((pB / .15) * .85).toFixed(2);
        let pC = (((pB / .15) * 0.036) + 3).toFixed(2);
        let pF = (parseFloat(pA) + parseFloat(pB) + parseFloat(pC)).toFixed(2);

        precioA.setAttribute('value', pA);
        precioC.setAttribute('value', pC);
        precioF.setAttribute('value', pF);
        precioA.value = pA;
        precioC.value = pC;
        precioF.value = pF;
    });

    precioC.addEventListener('keyup', function () {
        let digitadoC = precioC.value;

        let pC = parseFloat(digitadoC)

        let pA = (((pC - 3) / 0.036) * .85).toFixed(2);
        let pB = (((pC - 3) / 0.036) * .15).toFixed(2);
        let pF = (parseFloat(pA) + parseFloat(pB) + parseFloat(pC)).toFixed(2);

        precioA.setAttribute('value', pA);
        precioB.setAttribute('value', pB);
        precioF.setAttribute('value', pF);
        precioB.value = pB;
        precioA.value = pA;
        precioF.value = pF;
    });

    precioF.addEventListener('keyup', function () {
        let digitadoF = precioF.value;

        let pF = parseFloat(digitadoF);

        let pA = (((pF - 3) / 1.036) * .85).toFixed(2);
        let pB = (((pF - 3) / 1.036) * .15).toFixed(2);
        let pC = ((((pF - 3) / 1.036) * .036) + 3).toFixed(2);

        precioA.setAttribute('value', pA);
        precioC.setAttribute('value', pC);
        precioB.setAttribute('value', pB);
        precioB.value = pB;
        precioC.value = pC;
        precioA.value = pA;
    });


</script>